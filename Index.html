<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamXChat - Free Messaging Platform</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
            background: #f8fafc;
            overflow: hidden;
            color: #0f172a;
        }

        /* Auth Screen Styles */
        .auth-screen {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .auth-container {
            background: white;
            padding: 48px 40px;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
            width: 90%;
            max-width: 420px;
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #06b6d4, #8b5cf6, #ec4899, #06b6d4);
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
        }

        @keyframes shimmer {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        .logo-container {
            text-align: center;
            margin-bottom: 32px;
        }

        .app-logo {
            width: 90px;
            height: 90px;
            margin: 0 auto 20px;
            display: block;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .app-title {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #4facfe, #667eea);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 10s ease infinite;
            letter-spacing: -1px;
        }

        @keyframes gradientText {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .auth-subtitle {
            color: #64748b;
            font-size: 14px;
            margin-top: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #334155;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-label i {
            width: 16px;
            height: 16px;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
            background: #f8fafc;
        }

        .form-input:focus {
            outline: none;
            border-color: #06b6d4;
            background: white;
            box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1);
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn i {
            width: 20px;
            height: 20px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(6, 182, 212, 0.5);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            margin-top: 12px;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .error-message {
            background: #fef2f2;
            color: #dc2626;
            padding: 12px 16px;
            border-radius: 10px;
            margin-top: 16px;
            font-size: 14px;
            border: 1px solid #fecaca;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            background: #f0fdf4;
            color: #16a34a;
            padding: 12px 16px;
            border-radius: 10px;
            margin-top: 16px;
            font-size: 14px;
            border: 1px solid #bbf7d0;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .auth-toggle {
            text-align: center;
            margin-top: 24px;
            color: #64748b;
            font-size: 14px;
        }

        .auth-toggle a {
            color: #06b6d4;
            text-decoration: none;
            font-weight: 600;
            margin-left: 4px;
            cursor: pointer;
        }

        .auth-toggle a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none !important;
        }

        /* Main App Styles */
        .app-container {
            display: none;
            height: 100vh;
            flex-direction: column;
            background: #f8fafc;
        }

        .app-container.active {
            display: flex;
        }

        .app-header {
            background: white;
            padding: 16px 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .header-title {
            font-size: 26px;
            font-weight: 800;
            color: #0f172a;
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #4facfe, #667eea);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 3600s ease infinite;
        }

        .header-title i {
            width: 28px;
            height: 28px;
            color: #06b6d4;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            border: none;
            background: #f1f5f9;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: #e2e8f0;
            transform: scale(1.05);
        }

        .icon-btn i {
            width: 20px;
            height: 20px;
            color: #475569;
        }

        .profile-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            border: none;
            color: white;
            font-weight: 700;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
            overflow: hidden;
        }

        .profile-btn img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.4);
        }

        .app-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 100px;
        }

        .search-container {
            padding: 16px 20px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .search-wrapper {
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: #94a3b8;
        }

        .search-input {
            width: 100%;
            padding: 14px 16px 14px 48px;
            border: 2px solid #e2e8f0;
            border-radius: 14px;
            font-size: 15px;
            background: #f8fafc;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #06b6d4;
            background: white;
            box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.08);
        }

        /* Chat List Styles */
        .chat-item {
            padding: 16px 20px;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .chat-item:hover {
            background: #f8fafc;
        }

        .chat-item:active {
            background: #f1f5f9;
        }

        .avatar-wrapper {
            position: relative;
        }

        .avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 22px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.25);
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .online-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 14px;
            height: 14px;
            background: #10b981;
            border: 3px solid white;
            border-radius: 50%;
        }

        .chat-info {
            flex: 1;
            min-width: 0;
        }

        .chat-header-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .chat-name {
            font-weight: 700;
            color: #0f172a;
            font-size: 16px;
        }

        .chat-time {
            font-size: 12px;
            color: #94a3b8;
        }

        .chat-preview {
            font-size: 14px;
            color: #64748b;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .chat-preview i {
            width: 16px;
            height: 16px;
        }

        .unread-badge {
            background: #06b6d4;
            color: white;
            font-size: 12px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 12px;
            min-width: 20px;
            text-align: center;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-icon {
            width: 80px;
            height: 80px;
            color: #cbd5e1;
            margin: 0 auto 20px;
        }

        .empty-title {
            font-size: 20px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .empty-text {
            color: #64748b;
            font-size: 15px;
        }

        /* User Item */
        .user-item {
            padding: 16px 20px;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            align-items: center;
            gap: 14px;
            background: white;
            cursor: pointer;
        }

        .user-item:hover {
            background: #f8fafc;
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 700;
            color: #0f172a;
            font-size: 16px;
            margin-bottom: 2px;
        }

        .user-bio {
            font-size: 14px;
            color: #64748b;
        }

        .chat-btn {
            padding: 10px 20px;
            background: #06b6d4;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
        }

        .chat-btn:hover {
            background: #0891b2;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
        }

        .chat-btn i {
            width: 16px;
            height: 16px;
        }

        /* Stories/Posts Section */
        .stories-container {
            display: flex;
            gap: 16px;
            padding: 20px;
            overflow-x: auto;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .stories-container::-webkit-scrollbar {
            display: none;
        }

        .story-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .story-avatar-ring {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            padding: 3px;
            background: linear-gradient(45deg, #06b6d4, #8b5cf6, #ec4899);
            position: relative;
        }

        .story-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 24px;
            border: 3px solid white;
            overflow: hidden;
        }

        .story-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .add-story-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 24px;
            height: 24px;
            background: #06b6d4;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .add-story-btn i {
            width: 14px;
            height: 14px;
            color: white;
        }

        .story-name {
            font-size: 12px;
            color: #64748b;
            font-weight: 600;
        }

        /* Post Card */
        .post-card {
            background: white;
            border-radius: 16px;
            margin: 16px 20px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .post-header {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .post-author-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            overflow: hidden;
        }

        .post-author-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .post-author-info {
            flex: 1;
        }

        .post-author-name {
            font-weight: 700;
            font-size: 15px;
            color: #0f172a;
        }

        .post-time {
            font-size: 13px;
            color: #94a3b8;
        }

        .post-menu-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f8fafc;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .post-menu-btn:hover {
            background: #e2e8f0;
        }

        .post-menu-btn i {
            width: 18px;
            height: 18px;
            color: #64748b;
        }

        .post-content {
            padding: 0 16px 12px;
        }

        .post-text {
            font-size: 15px;
            line-height: 1.5;
            color: #334155;
            margin-bottom: 12px;
        }

        .post-images {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }

        .post-images::-webkit-scrollbar {
            height: 4px;
        }

        .post-images::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .post-images::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .post-image {
            min-width: 85%;
            max-width: 85%;
            height: 320px;
            border-radius: 12px;
            object-fit: cover;
            scroll-snap-align: start;
            cursor: pointer;
        }

        .post-video {
            min-width: 85%;
            max-width: 85%;
            height: 320px;
            border-radius: 12px;
            scroll-snap-align: start;
        }

        .post-stats {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            border-top: 1px solid #f1f5f9;
            font-size: 14px;
            color: #64748b;
        }

        .post-stat {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .post-stat i {
            width: 18px;
            height: 18px;
        }

        .post-actions {
            padding: 12px 16px;
            display: flex;
            gap: 8px;
            border-top: 1px solid #f1f5f9;
        }

        .post-action-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: #f8fafc;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 600;
            color: #475569;
            transition: all 0.2s;
        }

        .post-action-btn:hover {
            background: #e2e8f0;
        }

        .post-action-btn.liked {
            color: #ef4444;
        }

        .post-action-btn i {
            width: 18px;
            height: 18px;
        }

        /* Chat View */
        .chat-view {
            display: none;
            height: 100vh;
            flex-direction: column;
            background: #f8fafc;
        }

        .chat-view.active {
            display: flex;
        }

        .chat-header {
            padding: 16px 20px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 14px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f1f5f9;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: #e2e8f0;
        }

        .back-btn i {
            width: 20px;
            height: 20px;
            color: #0f172a;
        }

        .chat-user-info {
            flex: 1;
            cursor: pointer;
        }

        .chat-user-name {
            font-weight: 700;
            color: #0f172a;
            font-size: 17px;
        }

        .chat-user-status {
            font-size: 13px;
            color: #10b981;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 2px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
        }

        .chat-actions {
            display: flex;
            gap: 8px;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .message {
            display: flex;
            gap: 8px;
            max-width: 75%;
            position: relative;
        }

        .message.own {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
            overflow: hidden;
        }

        .message-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .message-content {
            display: flex;
            flex-direction: column;
            max-width: 100%;
        }

        .message.own .message-content {
            align-items: flex-end;
        }

        .message-bubble {
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            position: relative;
            max-width: 100%;
        }

        .message.own .message-bubble {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.other .message-bubble {
            background: white;
            color: #0f172a;
            border: 1px solid #e2e8f0;
            border-bottom-left-radius: 4px;
        }

        .message-text {
            font-size: 15px;
            line-height: 1.5;
        }

        .message-file {
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 8px;
            cursor: pointer;
        }

        .message.other .message-file {
            background: #f8fafc;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: rgba(6, 182, 212, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .file-icon i {
            width: 20px;
            height: 20px;
            color: #06b6d4;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-size: 14px;
            font-weight: 600;
        }

        .file-size {
            font-size: 12px;
            opacity: 0.7;
        }

        .message-image {
            max-width: 250px;
            border-radius: 12px;
            margin-top: 8px;
            cursor: pointer;
        }

        .message-reply {
            font-size: 13px;
            padding: 8px;
            background: rgba(0, 0, 0, 0.05);
            border-left: 3px solid #06b6d4;
            border-radius: 6px;
            margin-bottom: 6px;
        }

        .message.own .message-reply {
            background: rgba(255, 255, 255, 0.2);
        }

        .reply-author {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .reply-text {
            opacity: 0.8;
        }

        .message-time {
            font-size: 11px;
            margin-top: 4px;
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .message-like {
            position: absolute;
            bottom: -8px;
            right: 8px;
            background: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .message-like i {
            width: 14px;
            height: 14px;
            color: #ef4444;
        }

        .like-animation {
            position: fixed;
            pointer-events: none;
            animation: likeFloat 1s ease-out forwards;
        }

        @keyframes likeFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
      }


.message-input-container {
            padding: 16px 20px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .reply-preview {
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: white;
            padding: 12px 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .reply-preview-content {
            flex: 1;
        }

        .reply-preview-label {
            font-size: 12px;
            color: #06b6d4;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .reply-preview-text {
            font-size: 14px;
            color: #64748b;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .attachment-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: #f1f5f9;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .attachment-btn:hover {
            background: #e2e8f0;
        }

        .attachment-btn i {
            width: 20px;
            height: 20px;
            color: #64748b;
        }

        .message-input {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 24px;
            font-size: 15px;
            background: #f8fafc;
            transition: all 0.3s;
            resize: none;
            max-height: 120px;
            overflow-y: auto;
        }

        .message-input:focus {
            outline: none;
            border-color: #06b6d4;
            background: white;
        }

        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: #06b6d4;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
            flex-shrink: 0;
        }

        .send-btn:hover {
            background: #0891b2;
            transform: scale(1.05);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        .send-btn i {
            width: 20px;
            height: 20px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 16px;
            left: 16px;
            right: 16px;
            background: white;
            border-radius: 28px;
            padding: 8px 16px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
            border: 1px solid #e2e8f0;
            z-index: 50;
        }

        .nav-item {
            padding: 14px 28px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 18px;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            color: #94a3b8;
        }

        .nav-item:hover {
            background: #f8fafc;
        }

        .nav-item.active {
            background: rgba(6, 182, 212, 0.1);
            color: #06b6d4;
        }

        .nav-item i {
            width: 24px;
            height: 24px;
        }

        .nav-item span {
            font-size: 12px;
            font-weight: 700;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 32px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 800;
            color: #0f172a;
        }

        .close-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f1f5f9;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: #e2e8f0;
        }

        .close-btn i {
            width: 20px;
            height: 20px;
            color: #475569;
        }

        /* Profile Modal */
        .profile-info {
            text-align: center;
            margin-bottom: 24px;
        }

        .profile-avatar-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 40px;
            margin: 0 auto 16px;
            box-shadow: 0 8px 24px rgba(6, 182, 212, 0.3);
            overflow: hidden;
            cursor: pointer;
            position: relative;
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-avatar-large:hover::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-name {
            font-size: 22px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 6px;
        }

        .profile-identifier {
            font-size: 14px;
            color: #64748b;
        }

        .profile-code-box {
            background: #fef3c7;
            border: 2px solid #fbbf24;
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
        }

        .code-label {
            font-size: 12px;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .code-label i {
            width: 16px;
            height: 16px;
        }

        .code-value {
            font-size: 24px;
            font-weight: 800;
            color: #78350f;
            letter-spacing: 2px;
            text-align: center;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-btn {
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .action-btn i {
            width: 20px;
            height: 20px;
        }

        .block-btn {
            background: #fbbf24;
            color: #78350f;
        }

        .block-btn:hover {
            background: #f59e0b;
        }

        .logout-btn {
            background: #ef4444;
            color: white;
        }

        .logout-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(239, 68, 68, 0.3);
        }

        /* Create Post Modal */
        .create-post-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .post-textarea {
            width: 100%;
            min-height: 120px;
            padding: 14px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            resize: vertical;
            background: #f8fafc;
        }

        .post-textarea:focus {
            outline: none;
            border-color: #06b6d4;
            background: white;
        }

        .post-images-preview {
            display: flex;
            gap: 8px;
            overflow-x: auto;
        }

        .preview-image-wrapper {
            position: relative;
            min-width: 100px;
            height: 100px;
        }

        .preview-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }

        .remove-image-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 24px;
            height: 24px;
            background: #ef4444;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-image-btn i {
            width: 14px;
            height: 14px;
        }

        .post-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .post-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .option-label {
            font-size: 15px;
            color: #334155;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .option-label i {
            width: 18px;
            height: 18px;
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 28px;
            background: #cbd5e1;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: #06b6d4;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .toggle-switch.active::after {
            left: 23px;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            padding: 12px;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            background: #f8fafc;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: #64748b;
            font-weight: 600;
            transition: all 0.2s;
        }

        .upload-btn:hover {
            border-color: #06b6d4;
            background: white;
            color: #06b6d4;
        }

        .upload-btn i {
            width: 20px;
            height: 20px;
        }

        /* Image Viewer */
        .image-viewer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }

        .image-viewer.active {
            display: flex;
        }

        .viewer-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 48px;
            height: 48px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .viewer-close i {
            width: 24px;
            height: 24px;
        }

        .viewer-download {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 14px 24px;
            background: #06b6d4;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .viewer-download i {
            width: 20px;
            height: 20px;
        }

        /* Account Switcher */
        .account-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 300px;
            overflow-y: auto;
        }

        .account-item {
            padding: 14px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .account-item:hover {
            border-color: #06b6d4;
            background: #f8fafc;
        }

        .account-item.active {
            border-color: #06b6d4;
            background: rgba(6, 182, 212, 0.1);
        }

        .account-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            overflow: hidden;
        }

        .account-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .account-info {
            flex: 1;
        }

        .account-name {
            font-weight: 700;
            color: #0f172a;
        }

        .account-identifier {
            font-size: 13px;
            color: #64748b;
        }

        /* Group Chat */
        .group-members {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .member-tag {
            padding: 6px 12px;
            background: #e0f2fe;
            color: #0369a1;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .member-tag i {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .user-checkbox {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        .user-checkbox:hover {
            background: #f8fafc;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .checkbox.checked {
            background: #06b6d4;
            border-color: #06b6d4;
        }

        .checkbox i {
            width: 14px;
            height: 14px;
            color: white;
        }

        /* Context Menu */
        .context-menu {
            position: fixed;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 8px;
            z-index: 150;
            min-width: 180px;
            display: none;
        }

        .context-menu.active {
            display: block;
        }

        .context-menu-item {
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .context-menu-item:hover {
            background: #f8fafc;
        }

        .context-menu-item.danger {
            color: #ef4444;
        }

        .context-menu-item i {
            width: 18px;
            height: 18px;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #94a3b8;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Responsive Design */
        @media (max-width: 640px) {
            .auth-container {
                padding: 32px 24px;
            }

            .app-title {
                font-size: 32px;
            }

            .header-title {
                font-size: 22px;
            }

            .nav-item {
                padding: 12px 20px;
            }

            .nav-item span {
                font-size: 11px;
            }

            .post-image, .post-video {
                min-width: 100%;
                max-width: 100%;
            }
        }

        /* Utilities */
        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 8px;
        }

        .mb-2 {
            margin-bottom: 8px;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e2e8f0;
            border-top-color: #06b6d4;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        
@keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #94a3b8;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Responsive Design */
        @media (max-width: 640px) {
            .auth-container {
                padding: 32px 24px;
            }

            .app-title {
                font-size: 32px;
            }

            .header-title {
                font-size: 22px;
            }

            .nav-item {
                padding: 12px 20px;
            }

            .nav-item span {
                font-size: 11px;
            }

            .post-image, .post-video {
                min-width: 100%;
                max-width: 100%;
            }
        }

        /* Utilities */
        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 8px;
        }

        .mb-2 {
            margin-bottom: 8px;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e2e8f0;
            border-top-color: #06b6d4;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .loading-text {
            margin-top: 20px;
            font-size: 16px;
            color: #64748b;
            font-weight: 600;
        }
    </style>
</head>
<body>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading StreamXChat...</div>
    </div>

    <!-- Authentication Screen -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="logo-container">
                <img src="https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/696781b5cd24aaa6f7244a06/b681b950d_Screenshot_20251203_143408_Chrome.jpg" alt="StreamXChat Logo" class="app-logo">
                <div class="app-title">StreamXChat</div>
                <div class="auth-subtitle">Free messaging for everyone</div>
            </div>

            <!-- Login Form -->
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="user"></i>
                        Phone or Email
                    </label>
                    <input type="text" class="form-input" id="loginIdentifier" placeholder="+1234567890 or email@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="lock"></i>
                        Password
                    </label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="log-in"></i>
                    Sign In
                </button>
                <button type="button" class="btn btn-secondary" onclick="showForgotPassword()">
                    <i data-lucide="key"></i>
                    Forgot Password?
                </button>
                <div id="loginError" class="error-message"></div>
                <div class="auth-toggle">
                    Don't have an account? <a onclick="showSignup()">Sign Up</a>
                </div>
            </form>

            <!-- Signup Form -->
            <form id="signupForm" class="hidden" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="user-plus"></i>
                        Full Name
                    </label>
                    <input type="text" class="form-input" id="signupName" placeholder="John Doe" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="mail"></i>
                        Phone or Email
                    </label>
                    <input type="text" class="form-input" id="signupIdentifier" placeholder="+1234567890 or email@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="shield"></i>
                        Password
                    </label>
                    <input type="password" class="form-input" id="signupPassword" placeholder="Create a strong password" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="user-check"></i>
                    Create Account
                </button>
                <div id="signupError" class="error-message"></div>
                <div id="signupSuccess" class="success-message"></div>
                <div class="auth-toggle">
                    Already have an account? <a onclick="showLogin()">Sign In</a>
                </div>
            </form>

            <!-- Forgot Password Form -->
            <form id="forgotForm" class="hidden" onsubmit="handleResetPassword(event)">
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="user"></i>
                        Phone or Email
                    </label>
                    <input type="text" class="form-input" id="forgotIdentifier" placeholder="+1234567890 or email@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="hash"></i>
                        6-Digit Reset Code
                    </label>
                    <input type="text" class="form-input" id="resetCode" placeholder="Enter your 6-digit code" maxlength="6" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="lock"></i>
                        New Password
                    </label>
                    <input type="password" class="form-input" id="newPassword" placeholder="Enter new password" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="check-circle"></i>
                    Reset Password
                </button>
                <button type="button" class="btn btn-secondary" onclick="showLogin()">
                    <i data-lucide="arrow-left"></i>
                    Back to Login
                </button>
                <div id="resetError" class="error-message"></div>
                <div id="resetSuccess" class="success-message"></div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app-container">
        <div class="app-header">
            <h1 class="header-title" id="headerTitle">
                <i data-lucide="messages-square"></i>
                StreamXChat
            </h1>
            <div class="header-actions">
                <button class="icon-btn" onclick="showAccountSwitcher()">
                    <i data-lucide="users-round"></i>
                </button>
                <button class="icon-btn" onclick="showCreateGroup()">
                    <i data-lucide="user-plus"></i>
                </button>
                <button class="profile-btn" onclick="showProfile()" id="profileBtn">U</button>
            </div>
        </div>

        <div class="app-content" id="appContent">
            <!-- Messages Tab -->
            <div id="messagesTab">
                <div id="chatsList"></div>
            </div>

            <!-- Users Tab -->
            <div id="usersTab" class="hidden">
                <div class="search-container">
                    <div class="search-wrapper">
                        <i data-lucide="search" class="search-icon"></i>
                        <input type="text" class="search-input" id="userSearch" placeholder="Search people..." oninput="filterUsers()">
                    </div>
                </div>
                <div id="usersList"></div>
            </div>

            <!-- Stories/Posts Tab -->
            <div id="storiesTab" class="hidden">
                <div class="stories-container" id="storiesRow">
                    <div class="story-item" onclick="showCreatePost()">
                        <div class="story-avatar-ring">
                            <div class="story-avatar" id="myStoryAvatar">U</div>
                            <div class="add-story-btn">
                                <i data-lucide="plus"></i>
                            </div>
                        </div>
                        <div class="story-name">Your Story</div>
                    </div>
                </div>
                <div id="postsList"></div>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-item active" onclick="switchTab('messages')">
                <i data-lucide="message-circle"></i>
                <span>Chats</span>
            </button>
            <button class="nav-item" onclick="switchTab('users')">
                <i data-lucide="users"></i>
                <span>People</span>
            </button>
            <button class="nav-item" onclick="switchTab('stories')">
                <i data-lucide="image"></i>
                <span>Posts</span>
            </button>
        </div>
    </div>

    <!-- Chat View -->
    <div id="chatView" class="chat-view">
        <div class="chat-header">
            <button class="back-btn" onclick="closeChat()">
                <i data-lucide="arrow-left"></i>
            </button>
            <div class="avatar-wrapper">
                <div class="avatar" id="chatAvatar">U</div>
                <div class="online-indicator"></div>
            </div>
            <div class="chat-user-info" onclick="viewUserProfile()">
                <div class="chat-user-name" id="chatUserName">User</div>
                <div class="chat-user-status">
                    <div class="status-dot"></div>
                    Online
                </div>
            </div>
            <div class="chat-actions">
                <button class="icon-btn" onclick="showChatOptions()">
                    <i data-lucide="more-vertical"></i>
                </button>
            </div>
        </div>
        <div class="messages-container" id="messagesContainer"></div>
        <div class="message-input-container" style="position: relative;">
            <div id="replyPreview" class="reply-preview" style="display: none;">
                <div class="reply-preview-content">
                    <div class="reply-preview-label">Replying to <span id="replyTo"></span></div>
                    <div class="reply-preview-text" id="replyText"></div>
                </div>
                <button class="icon-btn" onclick="cancelReply()" style="width: 32px; height: 32px;">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <input type="file" id="fileInput" class="file-input" accept="*/*" onchange="handleFileSelect(event)">
            <button class="attachment-btn" onclick="document.getElementById('fileInput').click()">
                <i data-lucide="paperclip"></i>
            </button>
            <input type="text" class="message-input" id="messageInput" placeholder="Type a message..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button class="send-btn" onclick="sendMessage()">
                <i data-lucide="send"></i>
            </button>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal-overlay" onclick="if(event.target===this) closeProfile()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">My Profile</h2>
                <button class="close-btn" onclick="closeProfile()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="profile-info">
                <input type="file" id="profilePicInput" class="file-input" accept="image/*" onchange="handleProfilePicChange(event)">
                <div class="profile-avatar-large" id="profileAvatarLarge" onclick="document.getElementById('profilePicInput').click()">U</div>
                <div class="profile-name" id="profileName">User Name</div>
                <div class="profile-identifier" id="profileIdentifier">user@example.com</div>
            </div>
            <div class="profile-code-box">
                <div class="code-label">
                    <i data-lucide="key"></i>
                    Your Reset Code (Save it!)
                </div>
                <div class="code-value" id="resetCodeDisplay">000000</div>
            </div>
            <div class="profile-actions">
                <button class="action-btn logout-btn" onclick="logout()">
                    <i data-lucide="log-out"></i>
                    Logout
                </button>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="userProfileModal" class="modal-overlay" onclick="if(event.target===this) closeUserProfile()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">User Profile</h2>
                <button class="close-btn" onclick="closeUserProfile()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="profile-info">
                <div class="profile-avatar-large" id="userProfileAvatar">U</div>
                <div class="profile-name" id="userProfileName">User Name</div>
                <div class="profile-identifier" id="userProfileIdentifier">user@example.com</div>
            </div>
            <div class="profile-actions">
                <button class="action-btn chat-btn" onclick="startChatFromProfile()">
                    <i data-lucide="message-circle"></i>
                    Send Message
                </button>
                <button class="action-btn block-btn" id="blockBtn" onclick="toggleBlock()">
                    <i data-lucide="ban"></i>
                    <span id="blockBtnText">Block User</span>
                </button>
            </div>
        </div>
    </div>
        
<!-- User Profile Modal -->
    <div id="userProfileModal" class="modal-overlay" onclick="if(event.target===this) closeUserProfile()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">User Profile</h2>
                <button class="close-btn" onclick="closeUserProfile()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="profile-info">
                <div class="profile-avatar-large" id="userProfileAvatar">U</div>
                <div class="profile-name" id="userProfileName">User Name</div>
                <div class="profile-identifier" id="userProfileIdentifier">user@example.com</div>
            </div>
            <div class="profile-actions">
                <button class="action-btn chat-btn" onclick="startChatFromProfile()">
                    <i data-lucide="message-circle"></i>
                    Send Message
                </button>
                <button class="action-btn block-btn" id="blockBtn" onclick="toggleBlock()">
                    <i data-lucide="ban"></i>
                    <span id="blockBtnText">Block User</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Create Post Modal -->
    <div id="createPostModal" class="modal-overlay" onclick="if(event.target===this) closeCreatePost()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Post</h2>
                <button class="close-btn" onclick="closeCreatePost()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <form class="create-post-form" onsubmit="handleCreatePost(event)">
                <textarea class="post-textarea" id="postText" placeholder="What's on your mind?"></textarea>
                
                <div id="postImagesPreview" class="post-images-preview"></div>
                
                <input type="file" id="postImagesInput" class="file-input" accept="image/*,video/*" multiple onchange="handlePostImagesSelect(event)">
                <label for="postImagesInput" class="upload-btn">
                    <i data-lucide="image"></i>
                    Add Photos/Videos (Max 5 images or 1 video)
                </label>

                <div class="post-options">
                    <div class="post-option">
                        <div class="option-label">
                            <i data-lucide="message-square"></i>
                            Allow Comments
                        </div>
                        <div class="toggle-switch active" id="commentsToggle" onclick="toggleComments()"></div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i data-lucide="send"></i>
                    Post
                </button>
            </form>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="createGroupModal" class="modal-overlay" onclick="if(event.target===this) closeCreateGroup()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Group</h2>
                <button class="close-btn" onclick="closeCreateGroup()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <form class="create-post-form" onsubmit="handleCreateGroup(event)">
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="users"></i>
                        Group Name
                    </label>
                    <input type="text" class="form-input" id="groupName" placeholder="Enter group name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i data-lucide="user-plus"></i>
                        Select Members
                    </label>
                    <div id="groupMembersPreview" class="group-members"></div>
                    <div id="groupUsersList" style="max-height: 300px; overflow-y: auto;"></div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i data-lucide="check"></i>
                    Create Group
                </button>
            </form>
        </div>
    </div>

    <!-- Account Switcher Modal -->
    <div id="accountSwitcherModal" class="modal-overlay" onclick="if(event.target===this) closeAccountSwitcher()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Switch Account</h2>
                <button class="close-btn" onclick="closeAccountSwitcher()">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="account-list" id="accountList"></div>
            <button class="btn btn-primary mt-2" onclick="addNewAccount()">
                <i data-lucide="user-plus"></i>
                Add Account
            </button>
        </div>
    </div>

    <!-- Image Viewer -->
    <div id="imageViewer" class="image-viewer">
        <button class="viewer-close" onclick="closeImageViewer()">
            <i data-lucide="x"></i>
        </button>
        <img id="viewerImage" class="viewer-image" src="" alt="Full view">
        <button class="viewer-download" onclick="downloadImage()">
            <i data-lucide="download"></i>
            Download
        </button>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" onclick="replyToMessage()">
            <i data-lucide="reply"></i>
            Reply
        </div>
        <div class="context-menu-item danger" onclick="deleteMessage()">
            <i data-lucide="trash-2"></i>
            Delete
        </div>
    </div>

    <!-- Firebase & Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Firebase Configuration
        const firebaseConfig = {
            databaseURL: "https://streamx-a4099-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Global State
        let currentUser = null;
        let currentChatId = null;
        let currentChatUser = null;
        let allUsers = {};
        let selectedPostImages = [];
        let replyingTo = null;
        let selectedGroupMembers = [];
        let messageContextTarget = null;
        let longPressTimer = null;
        let currentViewedUserId = null;

        // Local Storage for Quick Message Display
        const localMessages = {};

        // Initialize 20 default users and 30 default posts
        function initializeDefaults() {
            const defaultUsers = [
                { id: 'sarah_wilson', name: 'Sarah Wilson', identifier: '+1234567890', password: 'demo123', resetCode: '123456', bio: 'Travel enthusiast | Coffee lover ' },
                { id: 'mike_johnson', name: 'Mike Johnson', identifier: 'mike@example.com', password: 'demo123', resetCode: '234567', bio: 'Tech geek | Gamer ' },
                { id: 'emma_davis', name: 'Emma Davis', identifier: '+1987654321', password: 'demo123', resetCode: '345678', bio: 'Photographer  | Nature lover ' },
                { id: 'alex_brown', name: 'Alex Brown', identifier: 'alex@example.com', password: 'demo123', resetCode: '456789', bio: 'Fitness coach | Healthy lifestyle ' },
                { id: 'jessica_lee', name: 'Jessica Lee', identifier: '+1555123456', password: 'demo123', resetCode: '567890', bio: 'Artist  | Creative soul ' },
                { id: 'david_martinez', name: 'David Martinez', identifier: '+1444555666', password: 'demo123', resetCode: '678901', bio: 'Chef | Food enthusiast ' },
                { id: 'olivia_garcia', name: 'Olivia Garcia', identifier: 'olivia@example.com', password: 'demo123', resetCode: '789012', bio: 'Fashion blogger | Style icon ' },
                { id: 'james_rodriguez', name: 'James Rodriguez', identifier: '+1333444555', password: 'demo123', resetCode: '890123', bio: 'Developer | Code ninja ' },
                { id: 'sophia_miller', name: 'Sophia Miller', identifier: 'sophia@example.com', password: 'demo123', resetCode: '901234', bio: 'Yoga instructor | Mindfulness ' },
                { id: 'daniel_anderson', name: 'Daniel Anderson', identifier: '+1222333444', password: 'demo123', resetCode: '012345', bio: 'Musician | Guitar player ' },
                { id: 'mia_taylor', name: 'Mia Taylor', identifier: 'mia@example.com', password: 'demo123', resetCode: '112233', bio: 'Writer | Book lover ' },
                { id: 'ryan_thomas', name: 'Ryan Thomas', identifier: '+1111222333', password: 'demo123', resetCode: '223344', bio: 'Entrepreneur | Startup founder ' },
                { id: 'isabella_jackson', name: 'Isabella Jackson', identifier: 'isabella@example.com', password: 'demo123', resetCode: '334455', bio: 'Marketing specialist | Brand expert ' },
                { id: 'ethan_white', name: 'Ethan White', identifier: '+1999888777', password: 'demo123', resetCode: '445566', bio: 'Cyclist | Adventure seeker ' },
                { id: 'ava_harris', name: 'Ava Harris', identifier: 'ava@example.com', password: 'demo123', resetCode: '556677', bio: 'Interior designer | Home decor ' },
                { id: 'noah_martin', name: 'Noah Martin', identifier: '+1888777666', password: 'demo123', resetCode: '667788', bio: 'Photographer | Street art ' },
                { id: 'charlotte_thompson', name: 'Charlotte Thompson', identifier: 'charlotte@example.com', password: 'demo123', resetCode: '778899', bio: 'Dancer | Ballet instructor ' },
                { id: 'liam_moore', name: 'Liam Moore', identifier: '+1777666555', password: 'demo123', resetCode: '889900', bio: 'Film director | Cinema lover ' },
                { id: 'amelia_clark', name: 'Amelia Clark', identifier: 'amelia@example.com', password: 'demo123', resetCode: '990011', bio: 'Nurse | Healthcare hero ' },
                { id: 'mason_lewis', name: 'Mason Lewis', identifier: '+1666555444', password: 'demo123', resetCode: '001122', bio: 'Architect | Building dreams ' }
            ];

            defaultUsers.forEach(user => {
                db.ref('users/' + user.id).once('value', snapshot => {
                    if (!snapshot.exists()) {
                        db.ref('users/' + user.id).set({
                            name: user.name,
                            identifier: user.identifier,
                            password: user.password,
                            resetCode: user.resetCode,
                            bio: user.bio,
                            profilePic: null,
                            createdAt: Date.now(),
                            online: Math.random() > 0.5,
                            blockedUsers: []
                        });
                    }
                });
            });

            // Create 30 default posts
            const defaultPosts = [
                { userId: 'sarah_wilson', text: 'Just finished an amazing hike! The view was absolutely breathtaking ', allowComments: true },
                { userId: 'mike_johnson', text: 'New gaming setup complete! Ready for some epic sessions ', allowComments: true },
                { userId: 'emma_davis', text: 'Golden hour shots from today\'s photoshoot. Mother nature never disappoints! ', allowComments: true },
                { userId: 'alex_brown', text: 'Morning workout done! Remember, your body can do anything, it\'s your mind you need to convince ', allowComments: true },
                { userId: 'jessica_lee', text: 'Finished this painting today. Art is the way I express my soul ', allowComments: true },
                { userId: 'david_martinez', text: 'Experimenting with new recipes in the kitchen today! Food is love made edible ', allowComments: true },
                { userId: 'olivia_garcia', text: 'New fashion collection dropping soon! Stay tuned for some amazing styles ', allowComments: true },
                { userId: 'james_rodriguez', text: 'Just deployed a new feature to production. The feeling of seeing your code come to life ', allowComments: true },
                { userId: 'sophia_miller', text: 'Morning meditation session complete. Peace begins with a smile ', allowComments: true },
                { userId: 'daniel_anderson', text: 'Recording new tracks in the studio. Music is the universal language ', allowComments: true },
                { userId: 'mia_taylor', text: 'Just finished writing a new chapter. Every story deserves to be told ', allowComments: true },
                { userId: 'ryan_thomas', text: 'Exciting pitch meeting today! Building the future one idea at a time ', allowComments: true },
                { userId: 'isabella_jackson', text: 'Launched a successful campaign today! Marketing is all about connecting with people ', allowComments: true },
                { userId: 'ethan_white', text: '50km bike ride completed! The journey is the reward ', allowComments: true },
                { userId: 'ava_harris', text: 'New home makeover project finished! Your home should tell your story ', allowComments: true },
                { userId: 'noah_martin', text: 'Captured some incredible street art today. Every wall tells a story ', allowComments: true },
                { userId: 'charlotte_thompson', text: 'Dance rehearsal was intense today! Movement is poetry in motion ', allowComments: true },
                { userId: 'liam_moore', text: 'Wrapped up filming today. Making movies is creating magic ', allowComments: true },
                { userId: 'amelia_clark', text: 'Another day of making a difference in people\'s lives. Healthcare heroes unite! ', allowComments: true },
                { userId: 'mason_lewis', text: 'New architectural design approved! Buildings shape our world ', allowComments: true },
                { userId: 'sarah_wilson', text: 'Coffee and sunset views - the perfect end to a perfect day ', allowComments: true },
                { userId: 'mike_johnson', text: 'Just hit level 100 in my favorite game! Gaming is my passion ', allowComments: true },
                { userId: 'emma_davis', text: 'Nature photography is my therapy. Every sunrise is a new beginning ', allowComments: true },
                { userId: 'alex_brown', text: 'Leg day complete! No pain, no gain ', allowComments: true },
                { userId: 'jessica_lee', text: 'Art exhibition this weekend! Come see my latest work ', allowComments: true },
                { userId: 'david_martinez', text: 'Homemade pasta from scratch. Cooking is love in edible form ', allowComments: true },
                { userId: 'olivia_garcia', text: 'Fashion week was incredible! So much inspiration ', allowComments: true },
                { userId: 'james_rodriguez', text: 'Open source contribution accepted! Love this community ', allowComments: true },
                { userId: 'sophia_miller', text: 'Yoga retreat this weekend. Find your inner peace ', allowComments: true },
                { userId: 'daniel_anderson', text: 'Live concert tonight! Music brings us together ', allowComments: true }
            ];
